<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Coachingtest – Livskvalitet</title>
  <style>
    :root{
      --bg:#f7f7f8;--card:#ffffff;--ink:#111;--muted:#6b7280;--line:#e5e7eb;
      --black:#000;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;background:var(--bg);color:var(--ink)}
    .wrap{max-width:900px;margin:0 auto;padding:24px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:0 6px 24px rgba(0,0,0,.06);padding:24px}
    h1{font-size:clamp(20px,3vw,28px);margin:0 0 12px;font-weight:800}
    .muted{color:var(--muted)}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .btn{appearance:none;border:1px solid var(--ink);background:var(--ink);color:#fff;padding:10px 16px;border-radius:12px;cursor:pointer;font-weight:600;text-decoration:none;display:inline-block}
    .btn.sec{background:#fff;color:var(--ink)}
    .pill{border:1px solid var(--line);border-radius:12px;padding:10px 14px;cursor:pointer;user-select:none}
    .pill.sel{outline:2px solid var(--ink)}
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .prog{height:10px;background:#e5e7eb;border-radius:999px;overflow:hidden}
    .prog>div{height:100%;background:#111;width:0}
    .qarea{font-size:14px;color:var(--muted);margin-bottom:6px}
    .qtext{font-size:18px;font-weight:600;margin-bottom:12px}
    .actions{display:flex;justify-content:space-between;align-items:center;margin-top:16px}
    .stack{display:grid;gap:12px}
    .grid{display:grid;gap:16px}
    @media(min-width:720px){.grid{grid-template-columns:1fr 1fr}}
    .footnote{font-size:12px;color:var(--muted)}
    .hr{height:1px;background:var(--line);margin:12px 0}

    /* Poängvisning */
    .scoreWrap{display:grid;gap:10px;align-items:center}
    .gbar{position:relative;height:16px;border-radius:999px;background:#e5e7eb;overflow:hidden}
    .gfill{height:100%;width:0;background:var(--black)}
    .scoreBox{font-size:36px;font-weight:900;text-align:center;padding:4px 0;color:var(--black)}

    /* Områdesstaplar */
    .bar{height:16px;background:#e5e7eb;border-radius:999px;overflow:hidden}
    .bar>div{height:100%;width:0;background:var(--black)}

    /* CTA – vit text på svart */
    .cta{
      display:inline-block;text-decoration:none;color:#fff;background:#000;font-weight:800;
      padding:16px 20px;border-radius:20px;border:1px solid #000;
      box-shadow:0 2px 10px rgba(0,0,0,.15);
      transition:transform .05s ease, box-shadow .2s ease, background .2s ease;
      font-size:16px;
    }
    .cta:hover{transform:translateY(-1px); box-shadow:0 6px 16px rgba(0,0,0,.22); background:#111}
    .cta:focus{outline:3px solid rgba(0,0,0,.3); outline-offset:3px}
    .ctaWrap{display:flex;justify-content:center}

    /* Sekundära knappar rad */
    .btnRow{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" id="app"></div>
  </div>

  <script>
    const QUESTIONS = [
      { id:1, area:"Ekonomi", text:"Jag har en tydlig överblick över mina inkomster och utgifter.", type:"scale" },
      { id:2, area:"Ekonomi", text:"Jag har en buffert/sparande som gör att jag känner mig trygg.", type:"scale" },
      { id:3, area:"Ekonomi", text:"Jag oroar mig ofta för pengar.", type:"yn", reverse:true },
      { id:4, area:"Ekonomi", text:"Jag upplever att min ekonomiska situation är stabil.", type:"scale" },
      { id:5, area:"Ekonomi", text:"Jag kan betala mina räkningar i tid varje månad.", type:"yn" },
      { id:6, area:"Ekonomi", text:"Jag har kontroll över eventuella skulder.", type:"scale" },
      { id:7, area:"Ekonomi", text:"Jag har råd med sådant som ger mig livskvalitet (t.ex. resor, fritid).", type:"scale" },
      { id:8, area:"Ekonomi", text:"Jag har en långsiktig plan för min ekonomi.", type:"yn" },
      { id:9, area:"Ekonomi", text:"Min ekonomi skapar stress i mitt liv.", type:"yn", reverse:true },
      { id:10, area:"Ekonomi", text:"Jag känner mig nöjd med min ekonomiska situation just nu.", type:"scale" },
      { id:11, area:"Fysisk hälsa", text:"Jag äter en balanserad och näringsrik kost.", type:"scale" },
      { id:12, area:"Fysisk hälsa", text:"Jag tränar regelbundet (minst 2 gånger i veckan).", type:"yn" },
      { id:13, area:"Fysisk hälsa", text:"Jag känner mig pigg och energifylld under dagarna.", type:"scale" },
      { id:14, area:"Fysisk hälsa", text:"Jag får tillräckligt med sömn av god kvalitet.", type:"scale" },
      { id:15, area:"Fysisk hälsa", text:"Jag röker, snusar eller använder andra beroendeframkallande substanser.", type:"yn", reverse:true },
      { id:16, area:"Fysisk hälsa", text:"Jag upplever att min kropp fungerar bra i vardagen.", type:"scale" },
      { id:17, area:"Fysisk hälsa", text:"Jag hanterar stress på ett hälsosamt sätt.", type:"scale" },
      { id:18, area:"Fysisk hälsa", text:"Jag går på hälsokontroller eller följer upp min hälsa vid behov.", type:"yn" },
      { id:19, area:"Fysisk hälsa", text:"Jag är ofta sjuk eller upplever återkommande smärta.", type:"yn", reverse:true },
      { id:20, area:"Fysisk hälsa", text:"Jag är nöjd med min fysiska hälsa i nuläget.", type:"scale" },
      { id:21, area:"Relationer", text:"Jag har personer i mitt liv som jag kan lita på.", type:"scale" },
      { id:22, area:"Relationer", text:"Jag upplever att mina relationer ger mig energi snarare än tar energi.", type:"scale" },
      { id:23, area:"Relationer", text:"Jag har en nära vän som jag kan prata öppet med.", type:"yn" },
      { id:24, area:"Relationer", text:"Jag känner mig uppskattad av människor runt mig.", type:"scale" },
      { id:25, area:"Relationer", text:"Jag har konflikter som påverkar mig negativt i vardagen.", type:"yn", reverse:true },
      { id:26, area:"Relationer", text:"Jag upplever att min familj eller partner stöttar mig.", type:"scale" },
      { id:27, area:"Relationer", text:"Jag är nöjd med mitt sociala liv (antal vänner, umgänge, gemenskap).", type:"scale" },
      { id:28, area:"Relationer", text:"Jag känner mig ofta ensam.", type:"yn", reverse:true },
      { id:29, area:"Relationer", text:"Jag upplever att jag bidrar positivt till andras liv.", type:"scale" },
      { id:30, area:"Relationer", text:"Jag är nöjd med kvaliteten på mina relationer.", type:"scale" },
      { id:31, area:"Sysselsättning", text:"Jag är nöjd med mitt arbete eller min huvudsakliga sysselsättning.", type:"scale" },
      { id:32, area:"Sysselsättning", text:"Jag känner att jag utvecklas i mitt arbete/studier.", type:"scale" },
      { id:33, area:"Sysselsättning", text:"Jag känner mig ofta stressad av mitt arbete eller mina studier.", type:"yn", reverse:true },
      { id:34, area:"Sysselsättning", text:"Jag tycker att min sysselsättning känns meningsfull.", type:"scale" },
      { id:35, area:"Sysselsättning", text:"Jag upplever balans mellan arbete/studier och fritid.", type:"scale" },
      { id:36, area:"Sysselsättning", text:"Jag har en tydlig plan för min karriär eller framtida mål.", type:"yn" },
      { id:37, area:"Sysselsättning", text:"Jag känner att mina styrkor och förmågor kommer till nytta i det jag gör.", type:"scale" },
      { id:38, area:"Sysselsättning", text:"Jag har en arbetsmiljö som är hälsosam och trivsam.", type:"scale" },
      { id:39, area:"Sysselsättning", text:"Jag känner mig uppskattad av kollegor/medstudenter/arbetsgivare.", type:"scale" },
      { id:40, area:"Sysselsättning", text:"Jag skulle vilja förändra min nuvarande sysselsättning.", type:"yn", reverse:true },
    ];
    const AREAS = ["Ekonomi","Fysisk hälsa","Relationer","Sysselsättning"];

    const LINKS = {
      "Sysselsättning": "https://kalleandersson872-design.github.io/sysselsattning/",
      "Ekonomi":        "https://kalleandersson872-design.github.io/ekonomi1/",
      "Relationer":     "https://kalleandersson872-design.github.io/relationer/",
      "Fysisk hälsa":   "https://kalleandersson872-design.github.io/fysisk-halsa-test/",
    };

    let idx = 0;
    const answers = {};
    const app = document.getElementById('app');

    function mapAnswerToScore(q, value){
      if(q.type === 'scale'){ const v = Number(value); return v>=1 && v<=5 ? v : 0; }
      if(q.type === 'yn'){ const yes=q.reverse?1:5, no=q.reverse?5:1; return value==='Ja'?yes : value==='Nej'?no : 0; }
      return 0;
    }
    function summary(){
      const sums = Object.fromEntries(AREAS.map(a=>[a,0]));
      QUESTIONS.forEach(q=>{ sums[q.area] += mapAnswerToScore(q, answers[q.id]); });
      const scores = Object.fromEntries(AREAS.map(a=>[a, Math.round((sums[a]/50)*100)]));
      return {sums, scores};
    }
    const progress = ()=> Math.round(((idx+1)/QUESTIONS.length)*100);

    function render(){
      if(idx >= QUESTIONS.length){
        const {scores} = summary();
        const overallPct = Math.round(
          (scores['Ekonomi'] + scores['Fysisk hälsa'] + scores['Relationer'] + scores['Sysselsättning']) / 4
        );
        const overallPoints = overallPct * 10;

        const sorted = Object.entries(scores).sort((a,b)=>a[1]-b[1]);
        const lowest = sorted[0];
        const lowestArea = lowest ? lowest[0] : AREAS[0];
        const lowestVal  = lowest ? lowest[1] : 0;
        const targetUrl = LINKS[lowestArea];

        app.innerHTML = `
          <h1>Ditt resultat</h1>
          <div class="scoreWrap">
            <div class="gbar"><div class="gfill" style="width:${overallPct}%"></div></div>
            <div class="scoreBox">${overallPoints} poäng</div>
          </div>
          <div class="hr"></div>
          <div class="grid">
            ${AREAS.map(a=>`
              <div class="stack">
                <div style="display:flex;justify-content:space-between;align-items:center"><strong>${a}</strong><span>${scores[a]}%</span></div>
                <div class="bar"><div style="width:${scores[a]}%"></div></div>
              </div>
            `).join('')}
          </div>
          <div class="hr"></div>
          <div class="stack">
            <strong>Fördjupande test</strong>
            <div class="muted">Lägst resultat: <strong>${lowestArea}</strong> (${lowestVal}%).</div>
            <div class="ctaWrap">
              <a class="cta" href="${targetUrl}" target="_blank" rel="noopener">
                Öppna fördjupande test i ${lowestArea.toLowerCase()}
              </a>
            </div>
          </div>
          <div class="hr"></div>
          <div class="btnRow">
            <button class="btn sec" onclick="window.print()">Skriv ut / PDF</button>
            <button class="btn" onclick="location.reload()">Gör om testet</button>
          </div>
        `;
        return;
      }

      const q = QUESTIONS[idx];
      const val = answers[q.id];
      const pct = progress();

      app.innerHTML = `
        <div class="topbar">
          <h1>Coachingtest – Livskvalitet</h1>
          <div class="muted">Fråga ${idx+1} av ${QUESTIONS.length} · ${pct}%</div>
        </div>
        <div class="prog"><div style="width:${pct}%"></div></div>
        <div class="stack" style="margin-top:16px">
          <div class="qarea">${q.area}</div>
          <div class="qtext">${q.text}</div>
          <div class="row" id="opts"></div>
        </div>
        <div class="actions">
          <button class="btn sec" ${idx===0?'disabled':''} id="backBtn">Tillbaka</button>
          <button class="btn" ${val?"":"disabled"} id="nextBtn">${idx<QUESTIONS.length-1?"Nästa":"Visa resultat"}</button>
        </div>
        <div class="footnote">Alla frågor måste besvaras för att gå vidare.</div>
      `;

      const opts = document.getElementById('opts');
      if(q.type==='yn'){
        ['Ja','Nej'].forEach(opt=>{
          const el=document.createElement('div');
          el.className = 'pill' + (val===opt?' sel':'');
          el.textContent = opt;
          el.onclick = ()=>{ answers[q.id]=opt; render(); };
          opts.appendChild(el);
        });
      } else {
        [1,2,3,4,5].forEach(n=>{
          const el=document.createElement('div');
          el.className = 'pill' + (val===n?' sel':'');
          el.textContent = n;
          el.onclick = ()=>{ answers[q.id]=n; render(); };
          opts.appendChild(el);
        });
      }

      document.getElementById('backBtn').onclick = ()=>{ if(idx>0){ idx--; render(); }};
      document.getElementById('nextBtn').onclick = ()=>{ if(answers[q.id]!==undefined){ idx++; render(); }};
    }

    render();
  </script>
</body>
</html>
